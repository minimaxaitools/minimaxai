<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Infinite Canvas</title>
    <link rel="stylesheet" href="css/main.css"/>
    <link rel="stylesheet" href="css/modern-overlay.css"/>
    <meta name="description" content="Draw on a canvas with very deep Zoom."/>
    <meta name="title" content="app"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>

</head>
<body>
<main>
    <canvas></canvas>
    <div class="toolbar">
        <div class="scroll">
            <h3>Colors</h3>
            <label>Fill Color: <input type="color" data-prop="color" value="#000000"/></label><br/>
            <label>Outline Color: <input type="color" data-prop="strokeColor" value="#000000"/></label><br/>
            <label>Background Color: <input type="color" data-prop="bgColor" value="#ffffff"/></label><br/>
            <button class="palette" data-palettecolor="#ff0000"></button>
            <button class="palette" data-palettecolor="#ff8000"></button>
            <button class="palette" data-palettecolor="#ffff00"></button>
            <button class="palette" data-palettecolor="#80ff00"></button>
            <button class="palette" data-palettecolor="#00ff00"></button>
            <button class="palette" data-palettecolor="#00ff80"></button>
            <button class="palette" data-palettecolor="#00ffff"></button>
            <button class="palette" data-palettecolor="#0080ff"></button>
            <button class="palette" data-palettecolor="#0000ff"></button>
            <button class="palette" data-palettecolor="#8000ff"></button>
            <button class="palette" data-palettecolor="#ff00ff"></button>
            <button class="palette" data-palettecolor="#909090"></button>
            <button class="palette" data-palettecolor="#c0c0c0"></button>
            <button class="palette" data-palettecolor="#ffffff"></button>
            <br/>
            <button class="palette" data-palettecolor="#800000"></button>
            <button class="palette" data-palettecolor="#804000"></button>
            <button class="palette" data-palettecolor="#808000"></button>
            <button class="palette" data-palettecolor="#408000"></button>
            <button class="palette" data-palettecolor="#008000"></button>
            <button class="palette" data-palettecolor="#008040"></button>
            <button class="palette" data-palettecolor="#008080"></button>
            <button class="palette" data-palettecolor="#004080"></button>
            <button class="palette" data-palettecolor="#000080"></button>
            <button class="palette" data-palettecolor="#400080"></button>
            <button class="palette" data-palettecolor="#800080"></button>
            <button class="palette" data-palettecolor="#000000"></button>
            <button class="palette" data-palettecolor="#303030"></button>
            <button class="palette" data-palettecolor="#606060"></button>
        </div>
        <div class="scroll">
            <h3>Options</h3>
            <label>Zoom Factor: <input type="number" min="1" max="100" step="0.1" value="1.05" data-prop="zoomFactor" checked/></label><br/>
            <label>Pan Speed: <input type="number" data-prop="panSpeed" value="1.0" step="0.1" min="0.1" max="5.0"/></label><br/>
            <label>Fill Enabled: <input type="checkbox" data-prop="fill" checked/></label><br/>
            <label>Outline Enabled: <input type="checkbox" data-prop="stroke"/></label><br/>
            <label>Auto Save: <input type="checkbox" data-prop="autoSave" checked/></label><br/>
            <label>Outline Thickness: <input type="number" data-prop="strokeSize" value="0.005" step="0.005" min="0.001" max="0.1"/></label><br/>
            <label>Alpha: <input type="number" data-prop="alpha" value="1" step="0.1" min="0" max="1"/></label><br/>

            <!-- Add this inside the toolbar div, in the Options section -->
            <div class="shape-scaling">
                <h4>Scale Object</h4>
                <label>Scale Factor:
                    <input type="number" id="scale-factor" value="2" step="0.1" min="0.1" max="80"/>
                </label>
                <input type="range" id="scale-slider" value="1" min="0.1" max="95" step="0.1"/>
                <label>Slider Step:
                    <input type="number" id="scale-step" value="0.1" min="0.01" max="1" step="0.01"/>
                </label>
            </div>

            <!-- Shape ordering controls -->
            <button id="move_shape_top">Move to Front</button>
            <button id="move_shape_forward">Bring Forward</button>
            <button id="move_shape_backward">Send Backward</button>
            <button id="move_shape_bottom">Send to Back</button>
            <button id="clear_canvas">Clear Everything</button>

            <button id="reset_cam">Reset Camera</button>
            <button id="move_center">Move To Center</button>
            <br/>
            <!-- Find this section in your toolbar -->
            <button id="download">Download Canvas</button><br/>
            <input type="file" id="import_file" accept=".json" style="margin: 5px 0;"/><br/>
            <textarea id="import_text" rows="6"></textarea><br/>
            <button id="import">Import Canvas</button>
        </div>
        <div data-toolview="0" class="scroll">
            <h3>Circle</h3>
            <label>Brush Radius: <input type="number" data-prop="circle.radius" value="0.1" step="0.05" min="0.01" max="0.5"/></label><br/>
        </div>
        <div data-toolview="1" class="scroll">
            <h3>Rectangle</h3>
            <label>Brush Size X: <input type="number" data-prop="rectangle.w" value="0.1" step="0.05" min="0.01" max="0.5"/></label><br/>
            <label>Brush Size Y: <input type="number" data-prop="rectangle.h" value="0.1" step="0.05" min="0.01" max="0.5"/></label>
        </div>
        <div data-toolview="2" class="scroll">
            <h3>Polygon</h3>
            <label>Close Polygons: <input type="checkbox" data-prop="polygon.isClosed"/></label>
            <label>Smooth: <input type="checkbox" data-prop="polygon.isSmooth"/></label>
        </div>
        <div data-toolview="3" class="scroll">
            <h3>Text</h3>
            <label>Text Size: <input type="number" data-prop="text.size" value="0.05" step="0.05" min="0.01" max="0.5"/></label><br/>
            <label>Font: <input type="text" id="setting_font" data-prop="text.font" value="Montserrat"/></label><br/>
            <button class="align" data-textalign="lt">Left<br/>Top</button><button class="align" data-textalign="ct">Center<br/>Top</button><button class="align" data-textalign="rt">Right<br/>Top</button><br/>
            <button class="align" data-textalign="lm">Left<br/>Middle</button><button class="align" data-textalign="cm">Center<br/>Middle</button><button class="align" data-textalign="rm">Right<br/>Middle</button><br/>
            <button class="align" data-textalign="lb">Left<br/>Bottom</button><button class="align" data-textalign="cb">Center<br/>Bottom</button><button class="align" data-textalign="rb">Right<br/>Bottom</button>
        </div>
        <div data-toolview="4" class="scroll">
            <h3>Image</h3>
            <div class="image-select">

            </div>
            <label>Width: <input type="number" data-prop="image.w" value="0.2" step="0.05" min="0.01" max="0.5"/></label><br/>
            <label>Height: <input type="number" data-prop="image.h" value="0.2" step="0.05" min="0.01" max="0.5"/></label><br/>
            <label>Rotation: <input type="range" data-prop="image.rotation" value="0" step="any" min="0" max="6.28318530718"/></label><br/>
            <label>Blur: <input type="range" data-prop="image.blur" value="0" step="any" min="0" max="1"/></label><br/>
            <label>Hue Rotation: <input type="range" data-prop="image.hue" value="0" step="any" min="0" max="360"/></label><br/>
            <label>Brightness: <input type="number" data-prop="image.brightness" value="100" step="10" min="0" max="400"/> %</label><br/>
            <label>Contrast: <input type="number" data-prop="image.contrast" value="100" step="10" min="0" max="400"/> %</label><br/>
            <label>Saturation: <input type="number" data-prop="image.saturation" value="100" step="10" min="0" max="400"/> %</label><br/>
        </div>
        <div data-toolview="5" class="scroll">
            <label>Type: <input type="range" min="0" max="1" step="1" value="0" data-prop="gradient.type"/></label><br/>
            <label>Rotation: <input type="range" data-prop="gradient.rotation" value="0" step="any" min="0" max="6.28318530718"/></label><br/>
            <h4>Templates</h4>
            <div id="gradient_templates">

            </div>
            <button id="random_gradient">Randomize</button>
            <h4>Edit</h4>
            <div id="gradient_div"></div>
            <button id="add_gradient_color">Add Color</button>
        </div>
        <div data-toolview="6"></div>
        <div data-toolview="7">
            <label>Multi Select: <input type="checkbox" data-prop="select.multiSelect"/></label>
        </div>
        <div data-toolview="8" class="scroll">
            <h3>SVG</h3>
            <!-- In the SVG tool section -->
            <input type="file" id="svg-upload" accept=".svg" multiple/>
            <div class="svg-select">
                <!-- SVG previews will be added here dynamically -->
            </div>
            <label>Width: <input type="number" data-prop="svg.w" value="0.2" step="0.05" min="0.01" max="0.5"/></label><br/>
            <label>Height: <input type="number" data-prop="svg.h" value="0.2" step="0.05" min="0.01" max="0.5"/></label><br/>
            <label>Rotation: <input type="range" data-prop="svg.rotation" value="0" step="any" min="0" max="6.28318530718"/></label><br/>
            <input type="file" id="svg-upload" accept=".svg"/>
        </div>


        <div class="scroll">

            <h3>Tool</h3>
            <button class="tool" data-tool="0"><img src="images/tools/ellipse.png" alt="circle"/></button>
            <button class="tool" data-tool="1"><img src="images/tools/rectangle.png" alt="rectangle"/></button>
            <button class="tool" data-tool="2"><img src="images/tools/polygon.png" alt="polygon"/></button>
            <button class="tool" data-tool="3"><img src="images/tools/text.png" alt="text"/></button>
            <button class="tool" data-tool="4"><img src="images/tools/image.png" alt="image"/></button>
            <button class="tool" data-tool="5"><img src="images/tools/gradient.png" alt="gradient"/></button>
            <button class="tool" data-tool="6"><img src="images/tools/eraser.png" alt="eraser"/></button>
            <button class="tool" data-tool="7"><img src="images/tools/select.png" alt="select"/></button>
            <button class="tool" data-tool="8"><img src="images/tools/svg.png" alt="svg"/></button>
        </div>
        <div>
            <br/>
            <button id="minimize">Minimize</button>
        </div>
    </div>
    <!-- Add before </main> -->

    <!-- Add after your main toolbar div -->
    <div class="side-panels">

        <!-- Enhanced SVG Panel -->
        <div id="enhanced-svg-panel" class="side-panel">
            <div class="panel-header">
                <h3>SVG Library</h3>
                <div class="panel-controls">
                    <input type="text" id="svg-search" placeholder="Search SVGs...">
                    <label class="hover-preview-label">
                        <input type="checkbox" id="hover-preview">
                        Preview
                    </label>
                    <button class="panel-toggle">▼</button>
                </div>
            </div>

            <!-- Apply scrolling to panel-content when content overflows -->
            <div class="panel-content scroll">
                <div class="svg-controls">
                    <div class="control-group">
                        <label>Width:
                            <input type="number" data-prop="svg.w" value="0.2" step="0.05" min="0.01" max="0.5">
                        </label>
                        <label>Height:
                            <input type="number" data-prop="svg.h" value="0.2" step="0.05" min="0.01" max="0.5">
                        </label>
                        <label>Rotation:
                            <input type="range" data-prop="svg.rotation" value="0" step="any" min="0" max="6.28318530718">
                        </label>
                    </div>
                </div>

                <!-- This grid will scroll when there are more items -->
                <div class="svg-grid scroll">
                    <!-- SVG items will be added here -->
                </div>
            </div>
        </div>

    </div>



    <div id="bookmarks-panel" class="ui-panel">
        <div class="panel-header">
            <span>Bookmarks</span>
            <span class="panel-toggle">≡</span>
        </div>
        <div id="bookmarks-list"></div>
        <div class="panel-controls">
            <button onclick="BookmarkManager.addBookmark()">Add Bookmark</button>
            <button onclick="BookmarkManager.playTour()">Play Tour</button>
            <button onclick="BookmarkManager.clearBookmarks()">Clear All</button>
        </div>
    </div>

    <div id="tour-controls" style="display: none;">
        <button class="tour-button prev-btn" onclick="BookmarkManager.previousBookmark()">⏮</button>
        <button class="tour-button play-pause-btn" onclick="BookmarkManager.togglePlayPause()">⏸</button>
        <button class="tour-button next-btn" onclick="BookmarkManager.nextBookmark()">⏭</button>
        <button class="tour-button stop-btn" onclick="BookmarkManager.stopTour()">⏹</button>
        <div class="tour-progress">
            <span class="current-slide">0</span>/<span class="total-slides">0</span>
        </div>
    </div>
    <!-- Add after #tour-controls div -->
    <!-- Update the video-export-controls div -->
    <div id="video-export-controls" class="video-export-controls">
        <h3>Video Export</h3>
        <div class="video-settings">
            <label for="video-quality">Quality</label>
            <select id="video-quality">
                <option value="highm">Mobile High Quality (1080p)</option>
                <option value="high">High Quality (1080p)</option>
                <option value="medium">Medium Quality (720p)</option>
                <option value="low">Low Quality (480p)</option>
            </select>

            <label for="video-format">Format</label>
            <select id="video-format">
                <option value="webm">WebM</option>
                <option value="mp4">MP4</option>
            </select>

            <!-- Add watermark controls -->
            <div class="watermark-controls">
                <label>
                    <input type="checkbox" id="show-watermark" checked>
                    Show Watermark
                </label>
                <button id="select-watermark" class="small-button">Select Watermark SVG</button>
                <input type="file" id="watermark-upload" accept=".svg" style="display: none;">
            </div>
        </div>
        <button id="export-video-btn" class="export-button">Export Tour as Video</button>
        <div class="video-progress">
            <div class="video-progress-bar"></div>
        </div>
    </div>

    <div id="recording-indicator" class="recording-indicator">
        Recording<span class="recording-timer">00:00</span>
    </div>
</main>
<script src="js/modern-overlay.js"></script>
<!-- Load Decimal.js from CDN first -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/decimal.js/10.4.3/decimal.min.js"></script>

<!-- Then load our decimal.js configuration -->
<script src="js/decimal.js"></script>

<!-- Core dependencies that use Decimal -->
<script src="js/vec2.js"></script>
<script src="js/utils.js"></script>
<script src="js/camera.js"></script>

<!-- External dependencies -->
<script src="https://cdn.jsdelivr.net/npm/recordrtc@5.6.2/RecordRTC.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.js"></script>

<!-- Application scripts -->
<script src="js/paneltoggle.js"></script>
<script src="js/chunkManager.js"></script>
<script src="js/vue.js"></script>
<script src="js/preload.js"></script>
<script src="js/shape.js"></script>
<script src="js/gradientmanager.js"></script>
<script src="js/bookmarkManager.js"></script>
<script src="js/enhancedBookmarkManager.js"></script>
<script src="js/enhancedSVGPanel.js"></script>
<script src="js/videoExporter.js"></script>
<script src="js/shortcutManager.js"></script>

<!-- Main application script must come last -->
<script src="js/main.js"></script>

</body>
</html>
